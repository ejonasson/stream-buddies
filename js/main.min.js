function queryTwitch(){Twitch.init({clientId:"cbmag59uju3vb9fevpi2de3pank5wtg"},function(){$.ajax({url:followsUrl,type:"GET",contentType:"application/json",dataType:"jsonp",cache:!0,error:function(){},success:function(data){return 404===data.status?($("#header-message").html(invalidUser),showingStream=!0,!1):void useJSON(data)}})})}function showOnline(streamArray){var name=streamArray.name,userURL=streamUrl+name;$.ajax({url:userURL,type:"GET",contentType:"application/json",dataType:"jsonp",cache:!0,async:!1,success:function(data){var streamObj={channelName:streamArray.name,viewerCount:viewerCount(data.stream),game:streamArray.game,status:streamArray.status,logo:streamArray.logo,display_name:streamArray.display_name,already_loaded:checkIfLoaded(streamArray.name),online:!1};null!==data.stream&&(streamObj.online=!0),addStream(streamObj)}})}function addStream(streamObj){if(streamObj.already_loaded)for(var i in loadedStreams)loadedStreams[i].name===streamObj.name&&(loadedStreams[i]=streamObj,loadedStreams[i].already_loaded=!0);else loadedStreams.push(streamObj)}function loadStreamFromObject(){for(var i in loadedStreams)if(loadedStreams[i].already_loaded){"#"+loadedStreams[i].channelName}else{var source=$("#stream-lister").html(),template=Handlebars.compile(source),thisStream=loadedStreams[i];loadedStreams[i].online===!0?($("#streamer-list").append(template(thisStream)),loadFirstStream(loadedStreams[i])):$("#offline-list").append(template(thisStream)),loadedStreams[i].already_loaded=!0}}function loadFirstStream(streamObj){var getFirstStreamID=$("#streamer-list > :first-child").attr("id");if(getFirstStreamID==streamObj.channelName){changeStream(streamObj.channelName);var FirstStreamID="#"+getFirstStreamID;$(FirstStreamID).addClass("selected-stream")}if(!showingStream){var FirstOnlineStreamID="#"+getFirstStreamID;showingStream=!0,changeStream(streamObj.channelName),$(FirstOnlineStreamID).addClass("selected-stream")}}function changeStream(streamer){var source=$("#stream-embed").html(),template=Handlebars.compile(source);for(var i in loadedStreams)if(loadedStreams[i].channelName===streamer){var streamObj=loadedStreams[i];$("#stream-area").html(template(streamObj)),setStreamSize()}}function setStreamSize(){var winWidth=$("#stream-area").innerWidth();winWidth=Math.floor(winWidth-825);var winHeight=Math.floor(.61*winWidth);winWidth>300&&($("#live_embed_player_flash").width(winWidth),$("#live_embed_player_flash").height(winHeight),$(".stream-chat").height(winHeight))}function noStreams(){showingStream||$("#header-message").html(offlineStreams.length>0?notFound:error)}function getQueryVariable(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1}function findUser(){var username="spartanerk",queryname=getQueryVariable("name");return queryname?queryname:username}function useJSON(JSON){for(var follows=JSON.follows,i=0;i<follows.length;i++){var streamArray=follows[i].channel;showOnline(streamArray)}}function checkIfLoaded(name){for(var i=0;i<loadedStreams.length;i++)if(loadedStreams[i].channelName===name)return!0;return!1}function viewerCount(data){if(null!==data){if(1==data.viewers){var string="1 viewer";return string}var viewString=data.viewers+" viewers";return viewString}return null}function takeStreamOffline(){}function takeStreamOnline(){}var loadedStreams=[],offlineStreams=[],theUser=findUser(),theURL="https://api.twitch.tv/kraken/",followsUrl=theURL+"users/"+theUser+"/follows/channels",streamUrl=theURL+"streams/",showingStream=!1,notFound="No Online Streams were found.",error="Twitch is taking longer than expected to respond.  Try refreshing your browser.",invalidUser="Error: We could not find a Twitch account by that name. Please check to make sure the name is spelled correctly.";$(document).ready(function(){queryTwitch(),setInterval(queryTwitch,1e5),setInterval(loadStreamFromObject,100),setTimeout(noStreams,7e3),$(document).on("click",".streamer",function(){$(".selected-stream").removeClass("selected-stream"),$(this).addClass("selected-stream");var streamerID=this.getAttribute("id");changeStream(streamerID)}),setStreamSize(),$(window).resize(function(){setStreamSize()})});