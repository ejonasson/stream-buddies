function getQueryVariable(variable){for(var query=window.location.search.substring(1),vars=query.split("&"),i=0;i<vars.length;i++){var pair=vars[i].split("=");if(pair[0]==variable)return pair[1]}return!1}function findUser(){var username="spartanerk",queryname=getQueryVariable("name");return queryname?queryname:username}function followers(){}function useJSON(JSON){for(var follows=JSON.follows,i=0;i<follows.length;i++){var streamArray=follows[i].channel;showOnline(streamArray)}}function showOnline(streamArray){var name=streamArray.name,userURL=streamUrl+name;$.ajax({url:userURL,type:"GET",contentType:"application/json",dataType:"jsonp",cache:!0,async:!1,success:function(data){if(null!==data.stream)addStream(streamArray,data);else{var inList=!1;for(var i in offlineStreams)offlineStreams[i]===name&&(inList=!0);inList||($("#offline-list").append(name+" "),offlineStreams.push(name))}}})}function addStream(followArray,streamData){function checkIfLoaded(){for(var i=0;i<loadedStreams.length;i++)if(loadedStreams[i].channelName===followArray.name)return!0;return!1}var streamObj={channelName:followArray.name,viewerCount:viewerCount(streamData.stream.viewers),game:followArray.game,status:followArray.status,logo:followArray.logo,display_name:followArray.display_name,already_loaded:checkIfLoaded(loadedStreams)};if(streamObj.already_loaded);else{var source=$("#stream-lister").html(),template=Handlebars.compile(source),thisStream=streamObj;loadedStreams.push(streamObj),console.log(loadedStreams),$("#streamer-list").append(template(thisStream));var getFirstStreamID=$("#streamer-list > :first-child").attr("id");if(getFirstStreamID==streamObj.channelName){changeStream(streamObj.channelName);var FirstStreamID="#"+getFirstStreamID;$(FirstStreamID).addClass("selected-stream")}showingStream||(showingStream=!0,changeStream(streamObj.channelName));var FirstOnlineStreamID="#"+getFirstStreamID;$(FirstOnlineStreamID).addClass("selected-stream")}}function viewerCount(viewers){if(1==viewers){var string="1 viewer";return string}var viewString=viewers+" viewers";return viewString}function changeStream(streamer){var source=$("#stream-embed").html(),template=Handlebars.compile(source);for(var i in loadedStreams)if(loadedStreams[i].channelName===streamer){var streamObj=loadedStreams[i];$("#stream-area").html(template(streamObj))}}function noStreams(){var notFound="<h2>No Online Streams were found.</h2>",error="<h2>Some kind of error has occurred. Try refreshing your browser to load your streams.</h2>";showingStream||(0==loadedStreams.length?$("#stream-area").html(notFound):(console.log(loadedStreams),$("#stream-area").html(error)))}var loadedStreams=[],offlineStreams=[],theUser=findUser(),theURL="https://api.twitch.tv/kraken/",followsUrl=theURL+"users/"+theUser+"/follows/channels",streamUrl=theURL+"streams/",showingStream=!1;$(document).ready(function(){function queryTwitch(){console.log("Requesting data from Twitch"),Twitch.init({clientId:"cbmag59uju3vb9fevpi2de3pank5wtg"},function(){$.ajax({url:followsUrl,type:"GET",contentType:"application/json",dataType:"jsonp",cache:!0,async:!1,success:function(data){console.log("success"),useJSON(data)}})})}queryTwitch(),setInterval(queryTwitch,6e4),setTimeout(noStreams,5e3),$(document).on("click",".streamer",function(){$(".selected-stream").removeClass("selected-stream"),$(this).addClass("selected-stream");var streamerID=this.getAttribute("id");changeStream(streamerID)})});